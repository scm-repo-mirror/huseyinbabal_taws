{
  "resources": {
    "secretsmanager-secrets": {
      "display_name": "Secrets Manager Secrets",
      "service": "secretsmanager",
      "sdk_method": "list_secrets",
      "sdk_method_params": {},
      "response_path": "secrets",
      "id_field": "ARN",
      "name_field": "Name",
      "is_global": false,
      "columns": [
        { "header": "SECRET NAME", "json_path": "Name", "width": 40 },
        { "header": "DESCRIPTION", "json_path": "Description", "width": 30 },
        { "header": "LAST ACCESSED", "json_path": "LastAccessedDate", "width": 25 },
        { "header": "LAST CHANGED", "json_path": "LastChangedDate", "width": 25 }
      ],
      "sub_resources": [],
      "actions": [
        { "key": "x", "display_name": "View Secret Value", "shortcut": "x", "sdk_method": "get_secret_value", "show_result": true },
        { "key": "R", "display_name": "Rotate Secret", "shortcut": "R", "sdk_method": "rotate_secret", "confirm": { "message": "Rotate secret", "default_yes": false } },
        { "key": "ctrl+d", "display_name": "Delete Secret", "shortcut": "ctrl+d", "sdk_method": "delete_secret", "confirm": { "message": "Delete secret", "default_yes": false, "destructive": true } }
      ],

      "api_config": {
        "protocol": "json",
        "action": "ListSecrets",
        "response_root": "/SecretList",
        "static_params": {
          "MaxResults": 100
        },
        "pagination": {
          "input_token": "NextToken",
          "output_token": "/NextToken"
        }
      },
      "field_mappings": {
        "Name": { "source": "/Name", "default": "-" },
        "ARN": { "source": "/ARN", "default": "-" },
        "Description": { "source": "/Description", "default": "-" },
        "LastAccessedDate": { "source": "/LastAccessedDate", "default": "-" },
        "LastChangedDate": { "source": "/LastChangedDate", "default": "-" }
      },
      "action_configs": {
        "delete_secret": {
          "action_id": "delete_secret",
          "protocol": "json",
          "action": "DeleteSecret",
          "body_template": "{\"SecretId\": \"{resource_id}\", \"ForceDeleteWithoutRecovery\": true}"
        },
        "rotate_secret": {
          "action_id": "rotate_secret",
          "protocol": "json",
          "action": "RotateSecret",
          "body_template": "{\"SecretId\": \"{resource_id}\"}"
        }
      },
      "describe_config": {
        "protocol": "json",
        "action": "DescribeSecret",
        "body_template": "{\"SecretId\": \"{resource_id}\"}"
      }
    }
  }
}
